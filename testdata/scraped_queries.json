[
  {"query": "where(source_user=\"grp adm\" action=\"ACCOUNT_DISABLED\")", "description": "Find specific action", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(source_user=\"grp adm\" action=\"ACCOUNT_DISABLED\") calculate(count)", "description": "Find specific action and count", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(asset=\"iphone_of_siem\")", "description": "Find specific device", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(4725)", "description": "Find specific event ID", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(client_mac=\"11:22:33:aa:bb:cc\")", "description": "Find specific Mac address", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "destination_account=\"alice.winchester\"", "description": "Search specific user", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(\"192.168.1.1\")", "description": "Find all logs for specific IP", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(source_ip=\"192.168.1.1\")", "description": "Find source logs for specific IP", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(source_address=\"192.168.1.1\")", "description": "Find source logs for specific IP (address variant)", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(destination_ip=\"192.168.1.1\")", "description": "Find destination logs for specific IP", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(destination_address=\"192.168.1.1\")", "description": "Find destination logs for specific IP (address variant)", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(source_port=\"22\")", "description": "Find specific source port", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(destination_port=\"443\")", "description": "Find specific destination port", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(http_method=\"get\")", "description": "Find HTTP GET method", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(http_method=\"post\")", "description": "Find HTTP POST method", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(url=\"https://google.com/\")", "description": "Find specific URL", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(url_host=\"google.com\")", "description": "Find specific host", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(direction=\"OUTBOUND\")", "description": "Find outbound traffic", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(direction=\"INTERNAL\")", "description": "Find internal traffic", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(/Alice (?P<VARIABLE>\\s*)/ )", "description": "Find user with regex pattern", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(/@domain.com/)", "description": "Find all email addresses", "source": "Outs1d3r-Net/InsightIDR-rapid7-SIEM-Cheat-Sheet"},
  {"query": "where(connection_status=DENY)groupby(source_address)", "description": "Denied connections grouped by source", "source": "pawan-regoti/Insight-IDR-LEQL-Cheat-Sheet"},
  {"query": "where(source_ip=/192.168.1./)", "description": "Subnet search using regex", "source": "pawan-regoti/Insight-IDR-LEQL-Cheat-Sheet"},
  {"query": "where(result=FAILED_BAD_LOGIN)calculate(UNIQUE:source_ip)", "description": "Unique IPs for failed login attempts", "source": "pawan-regoti/Insight-IDR-LEQL-Cheat-Sheet"},
  {"query": "where(service=0365 AND result=FAILED_BAD_LOGIN)groupby(source_ip)", "description": "Office365 failed logins grouped by IP", "source": "pawan-regoti/Insight-IDR-LEQL-Cheat-Sheet"},
  {"query": "where(/facebook/ AND user!=\"unknown\")group_by(user)", "description": "Facebook users on network", "source": "pawan-regoti/Insight-IDR-LEQL-Cheat-Sheet"},
  {"query": "where(geoip_country_code!=US)groupby(geoip_country_name)sort(desc)", "description": "Countries sorted descending excluding US", "source": "pawan-regoti/Insight-IDR-LEQL-Cheat-Sheet"},
  {"query": "where(connection_status=DENY) groupby(source_address)", "description": "PCI 1.3.5 Denied connection attempts", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=/4692|4693|4694|4695|4688|4696|4689|5712|4928|4929|4930|4931|4934|4935|4936|4937|4662|5169|5137|5138|5141|5136|5139|4932|4933|4668|4665|4666|4667|4818|4875|4876|4868|4869|4870|4871|4872|4873|4874|4877|4878|4879|4880|4881|4882|4883|4884|4885|4886|4887|4888|4889|4890|4891|4892|4893|4894|4895|4896|4897|4898|4899|4900|5120|5121|5122|5123|5124|5125|5126|5127|5145|5142|5144/ OR data.eventCode=/5140|5143|5168|4664|4985|5051|5031|5150|5151|5154|5155|5156|5157|5158|5159|5146|5147|5152|5153|4656|4658|4690|4660|4659|4661|4663|4698|4699|5889|5890|4671|4691|4700|4701|4702|5148|5149|5888|4657|5039|4660|4659|4661|4663|5478|4960|4961|4962|4963|4965|5479|5480|5483|5484|5485|5024|5025|5030|5027|5028|5029|5032|5033|5034|5035|5037|5050|5058|5059|5071|6400|6401|6402|6403|6404|6405|6406|6407|6408|6409|6420|6421|6422|6423|6424|6416|6419|4608|4609|4616|4621|4697|4610|4611|4614|4622|4618|5038|5057|4612|4615|4816|5056|5060|5061|5062|6281|6410|6417|6418/)groupby(data.computerName) limit(10000)", "description": "PCI 10.2.7 Create/delete system level objects (data variant)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=/4692|4693|4694|4695|4688|4696|4689|5712|4928|4929|4930|4931|4934|4935|4936|4937|4662|5169|5137|5138|5141|5136|5139|4932|4933|4668|4665|4666|4667|4818|4875|4876|4868|4869|4870|4871|4872|4873|4874|4877|4878|4879|4880|4881|4882|4883|4884|4885|4886|4887|4888|4889|4890|4891|4892|4893|4894|4895|4896|4897|4898|4899|4900|5120|5121|5122|5123|5124|5125|5126|5127|5145|5142|5144|5140|5143|5168|4664|4985|5051|5031|5150/ OR source_json.eventCode=/5151|5154|5155|5156|5157|5158|5159|5146|5147|5152|5153|4656|4658|4690|4660|4659|4661|4663|4698|4699|5889|5890|4671|4691|4700|4701|4702|5148|5149|5888|4657|5039|4660|4659|4661|4663|5478|4960|4961|4962|4963|4965|5479|5480|5483|5484|5485|5024|5025|5030|5027|5028|5029|5032|5033|5034|5035|5037|5050|5058|5059|5071|6400|6401|6402|6403|6404|6405|6406|6407|6408|6409|6420|6421|6422|6423|6424|6416|6419|4608|4609|4616|4621|4697|4610|4611|4614|4622|4618|5038|5057|4612|4615|4816|5056|5060|5061|5062|6281|6410|6417|6418/)groupby(source_json.computerName) limit(10000)", "description": "PCI 10.2.7 Create/delete system level objects (source_json variant)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=/4783|4784|4785|4786|4787|4788|4789|4790|4791|4792|4742|4743|4746|4751|4744|4745|4747|4748|4749|4750|4752|4753|4759|4760|4761|4762|4782|4793|4729|4733|4757|4727|4728|4730|4731|4732|4734|4735|4737|4754|4755|4756|4758|4764|4799|4720|4722|4723|4724|4725|4726|4767|4781|4797|4738|4740|4765|4766|4780|4794|4798|5376|5377/)groupby(source_json.computerName)limit(10000)", "description": "PCI 10.2.5c Changes to accounts with root/admin privileges (source_json)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=/4783|4784|4785|4786|4787|4788|4789|4790|4791|4792|4742|4743|4746|4751|4744|4745|4747|4748|4749|4750|4752|4753|4759|4760|4761|4762|4782|4793|4729|4733|4757|4727|4728|4730|4731|4732|4734|4735|4737|4754|4755|4756|4758|4764|4799|4720|4722|4723|4724|4725|4726|4767|4781|4797|4738|4740|4765|4766|4780|4794|4798|5376|5377/)groupby(data.computerName) limit(10000)", "description": "PCI 10.2.5c Changes to accounts with root/admin privileges (data variant)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=4624) groupby(xml.eventdata.targetusername) calculate(count) limit(10000)", "description": "PCI 10.2.5a Use of ID and auth mechanisms (data with calculate)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=4624) groupby(xml.eventdata.targetusername)", "description": "PCI 10.2.5a Use of ID and auth mechanisms (data basic)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=7036 AND Windows Event Log) groupby(data.computerName) limit(10000)", "description": "PCI 10.2.6 Init/stop/pause audit logs", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=4624) groupby(destination_account) calculate(count) limit(10000)", "description": "PCI 10.2.5a Use of ID and auth (source_json with account)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=4624) groupby(source_json.eventCode)", "description": "PCI 10.2.5a Use of ID and auth (source_json groupby event)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "groupby(destination_user)", "description": "PCI 7.1.2b User authentications", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(xml.system.eventid=/4715|4719|4902|4904|4905|4906|4907|4908|4912|4817|4739|4865|4866|4867|4713|4716|4717|4718|4864|4707|4913|4703|4704|4705|4706|4714|4911|4709|4710|4712|4711|5040|5041|5042|5043|5044|5045|5046|5047|5048|5440|5441|5442|5443|5444|5446|5448|5449|5450|5456|5457|5458|5459|5460|5461|5462|5463|5464|5465|5466|5467|5468|5471|5472|5473|5474|5477|4944|4945|4950|4954|4946|4947|4948|4949|4951|4952|4953|4956|4957|4958|4826|4819|4909|4910|5063|5064|5065|5066|5067|5068|5069|5070|5447|6144|6145|4670|4672|4673|4674/)groupby(xml.system.eventid)", "description": "Actions taken with root/admin privileges", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(destination_port = 80) groupby(source_address)", "description": "PCI 4.1c Potential insecure connections", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=4625) groupby(xml.eventdata.targetusername) calculate(count) limit(10000)", "description": "PCI 10.2.4 Invalid logical access attempts (data with calculate)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=4625) groupby(xml.eventdata.targetusername)", "description": "PCI 10.2.4 Invalid logical access attempts (data basic)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=4625) groupby(destination_account) calculate(count) limit(10000)", "description": "PCI 10.2.4 Invalid logical access attempts (source_json with account)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=4625) groupby(source_json.eventCode)", "description": "PCI 10.2.4 Invalid logical access attempts (source_json groupby event)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(result=FAILED_BAD_PASSWORD OR result=FAILED_BAD_LOGIN OR result = FAILED_OTHER) calculate(count) timeslice(60)", "description": "PCI 10.2.4 Failed logins over time", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(xml.system.eventid=/4777|4822|4823|4774|4775|4776|4772|4768|4771|4773|4820|4824|4769|4770|4821|4625|4627|4978|4979|4980|4981|4982|4983|4984|4646|4650|4651|4652|4653|4655|4976|5049|5453|4654|4977|5451|5452|4634|4647|4625|4624|4626|4648|4675|6273|6274|6275|6276|6279|6280|6272|6277|6278|4649|4825|4778|4779|4800|4801|4802|4803|5378|5632|5633|4964/)groupby(xml.system.eventid)", "description": "Failed logical access / ID and auth / elevation of privileges", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=4672) groupby(data.computerName) limit(10000)", "description": "PCI 10.2.5b Elevation of privileges (data 4672)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=4672)groupby(source_json.computerName) limit(10000)", "description": "PCI 10.2.5b Elevation of privileges (source_json 4672)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(xml.system.eventid=/4783|4784|4785|4786|4787|4788|4789|4790|4791|4792|4742|4743|4746|4751|4744|4745|4747|4748|4749|4750|4752|4753|4759|4760|4761|4762|4782|4793|4729|4733|4757|4727|4728|4730|4731|4732|4734|4735|4737|4754|4755|4756|4758|4764|4799|4720|4722|4723|4724|4725|4726|4767|4781|4797|4738|4740|4765|4766|4780|4794|4798|5376|5377/)groupby(xml.system.eventid)", "description": "Changes to root or admin accounts", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(xml.eventdata.param2=stopped AND xml.system.eventid=7036)groupby(xml.eventdata.param1)", "description": "PCI 10.2.6 Audit log changes", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(data.eventCode=/4715|4719|4902|4904|4905|4906|4907|4908|4912|4817|4739|4865|4866|4867|4713|4716|4717|4718|4864|4707|4913|4703|4704|4705|4706|4714|4911|4709|4710|4712|4711|5040|5041|5042|5043|5044|5045|5046|5047|5048|5440|5441|5442|5443|5444|5446|5448|5449|5450|5456|5457|5458|5459|5460|5461|5462|5463|5464|5465|5466|5467|5468|5471|5472|5473|5474|5477|4944|4945|4950|4954|4946|4947|4948|4949|4951|4952|4953|4956|4957|4958|4826|4819|4909|4910|5063|5064|5065|5066|5067|5068|5069|5070|5447|6144|6145|4670|4672|4673|4674/)groupby(data.computerName) limit(10000)", "description": "PCI 10.2.2 Actions taken with root/admin privileges (data variant)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(source_json.eventCode=/4715|4719|4902|4904|4905|4906|4907|4908|4912|4817|4739|4865|4866|4867|4713|4716|4717|4718|4864|4707|4913|4703|4704|4705|4706|4714|4911|4709|4710|4712|4711|5040|5041|5042|5043|5044|5045|5046|5047|5048|5440|5441|5442|5443|5444|5446|5448|5449|5450|5456|5457|5458|5459|5460|5461|5462|5463|5464|5465|5466|5467|5468|5471|5472|5473|5474|5477|4944|4945|4950|4954|4946|4947|4948|4949|4951|4952|4953|4956|4957|4958|4826|4819|4909|4910|5063|5064|5065|5066|5067|5068|5069|5070|5447|6144|6145|4670|4672|4673|4674/)groupby(source_json.computerName) limit(10000)", "description": "PCI 10.2.2 Actions taken with root/admin privileges (source_json variant)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(xml.system.eventid=/4715|4719|4902|4904|4905|4906|4907|4908|4912|4817|4739|4865|4866|4867|4713|4716|4717|4718|4864|4707|4913|4703|4704|4705|4706|4714|4911|4709|4710|4712|4711|5040|5041|5042|5043|5044|5045|5046|5047|5048|5440|5441|5442|5443|5444|5446|5448|5449|5450|5456|5457|5458|5459|5460|5461|5462|5463|5464|5465|5466|5467|5468|5471|5472|5473|5474|5477|4944|4945|4950|4954|4946|4947|4948|4949|4951|4952|4953|4956|4957|4958|4826|4819|4909|4910|5063|5064|5065|5066|5067|5068|5069|5070|5447|6144|6145|4670/)groupby(xml.system.eventid)", "description": "PCI 10.2.3 Access to all audit trails", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where((data.eventCode=4688 AND eventvwr.msc) OR (data.eventCode=4656 AND eventvwr.msc) OR (data.eventCode=4688 AND wevtutil.exe) OR (data.eventCode=4656 AND wevtutil.exe) (data.eventCode=4663 AND eventvwr.msc) OR (data.eventCode=4663 AND wevtutil.exe)  ) groupby(data.computerName) calculate(count) limit(1000)", "description": "PCI 10.2.3 Access to all audit trails (event viewer/wevtutil)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(xml.system.eventid=/4692|4693|4694|4695|4688|4696|4689|5712|4928|4929|4930|4931|4934|4935|4936|4937|4662|5169|5137|5138|5141|5136|5139|4932|4933|4668|4665|4666|4667|4818|4875|4876|4868|4869|4870|4871|4872|4873|4874|4877|4878|4879|4880|4881|4882|4883|4884|4885|4886|4887|4888|4889|4890|4891|4892|4893|4894|4895|4896|4897|4898|4899|4900|5120|5121|5122|5123|5124|5125|5126|5127|5145|5142|5144|5140|5143|5168|4664|4985/ OR xml.system.eventid=/5051|5031|5150|5151|5154|5155|5156|5157|5158|5159|5146|5147|5152|5153|4656|4658|4690|4660|4659|4661|4663|4698|4699|5889|5890|4671|4691|4700|4701|4702|5148|5149|5888|4657|5039|4660|4659|4661|4663|5478|4960|4961|4962|4963|4965|5479|5480|5483|5484|5485|5024|5025|5030|5027|5028|5029|5032|5033|5034|5035|5037|5050|5058|5059|5071|6400|6401|6402|6403|6404|6405|6406|6407|6408|6409|6420|6421|6422|6423|6424|6416|6419|4608|4609|4616|4621|4697|4610|4611|4614|4622|4618|5038|5057|4612|4615|4816|5056|5060|5061|5062|6281|6410|6417|6418/)groupby(xml.system.eventid)", "description": "PCI 10.2.7 Create/delete system level objects (xml.system variant)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(asset_os_family=windows) groupby(asset)", "description": "FIM Events per Windows Asset", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(asset_os_family=windows) groupby(file_event)", "description": "FIM Events by Event Type (Windows)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(asset_os_family=windows) groupby(user)", "description": "FIM Events per User (Windows)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(asset_os_family=windows) groupby(process)", "description": "FIM Events by Process (Windows)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(asset_os_family=windows) groupby(file_name) limit(100)", "description": "FIM Events by File Name (Windows)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(asset_os_family=windows) calculate(COUNT)timeslice(1440m)", "description": "FIM Events per Day (Windows)", "source": "rapid7/r7insight_analytic_packs/windows_pci.json"},
  {"query": "where(/duration: (?P<time>\\d+\\.\\d+) ms/) calculate(AVERAGE:time)", "description": "Slow query average time", "source": "rapid7/r7insight_analytic_packs/heroku_postgres.json"},
  {"query": "where(/(?P<severity>LOG|DEBUG|INFO|NOTICE|WARNING|FATAL|ERROR|PANIC)/) groupby(severity) calculate(COUNT)", "description": "Log severity levels distribution", "source": "rapid7/r7insight_analytic_packs/heroku_postgres.json"},
  {"query": "where(memory_total>0) calculate(average:memory_total)", "description": "Memory total average", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(memory_rss>0) calculate(average:memory_rss)", "description": "Memory RSS average", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(memory_cache>0) calculate(average:memory_cache)", "description": "Memory cache average", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(memory_swap>0) calculate(average:memory_swap)", "description": "Memory swap average", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(memory_pgpgin>0) calculate(average:memory_pgpgin)", "description": "Memory page-in average", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(memory_pgpgout>0) calculate(average:memory_pgpgout)", "description": "Memory page-out average", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(load_avg_1m>0) calculate(average:load_avg_1m)", "description": "Load average 1 minute", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(load_avg_5m>0) calculate(average:load_avg_5m)", "description": "Load average 5 minutes", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(load_avg_15m>0) calculate(average:load_avg_15m)", "description": "Load average 15 minutes", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(load_avg_1m>0) groupby(dyno) calculate(average:memory_total)", "description": "Load average 1m per dyno", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "where(memory_total>0) groupby(dyno) calculate(average:memory_total)", "description": "Memory total per dyno", "source": "rapid7/r7insight_analytic_packs/heroku_log_runtime_metrics.json"},
  {"query": "groupby(http.status) calculate(COUNT:http.status)", "description": "HTTP codes distribution", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "groupby(http.path) calculate(COUNT:http.path)", "description": "URL distribution", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "calculate(AVERAGE:http.bytes)", "description": "Total bytes average", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "where(http.status=401) groupby(http.path) calculate(COUNT:http.status)", "description": "401 errors by URL", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "where(http.status=200) groupby(http.path) calculate(COUNT:http.status)", "description": "200 OK by URL", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "where(http.status=404) groupby(http.path) calculate(COUNT:http.status)", "description": "404 errors by URL", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "where(http.status=500) groupby(http.path) calculate(COUNT:http.status)", "description": "500 errors by URL", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "calculate(unique:http.addr)", "description": "Unique IP count", "source": "rapid7/r7insight_analytic_packs/apache_combined.json"},
  {"query": "where(status>0) Calculate(unique:remote_addr)", "description": "Unique visitors count", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status!=404) GroupBy(request) Calculate(count)", "description": "Page view distribution", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status>0) groupby(status) calculate(count)", "description": "Status type distribution", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status>0) calculate(average:request_time)", "description": "Average response time", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status>0) groupby(request) calculate(average:request_time)", "description": "Average response time per page", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status>0) groupby(remote_addr) calculate(average:request_time)", "description": "Average response time over 40 users", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status>0) groupby(request) calculate(average:body_bytes_sent)", "description": "Average bytes sent per page", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status=404) Calculate(count)", "description": "Total 404 errors", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status=404) Groupby(request) Calculate(count)", "description": "404 URL distribution", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "where(status>0) Groupby(http_user_agent) Calculate(count)", "description": "User agent distribution", "source": "rapid7/r7insight_analytic_packs/apache_json.json"},
  {"query": "groupby(image) calculate(average:stats.memory_stats.usage) sort(desc)", "description": "Docker: Most memory by image", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "groupby(image) calculate(average:stats.cpu_stats.cpu_usage.total_usage) sort(desc)", "description": "Docker: Most CPU by image", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "groupby(name) calculate(average:stats.memory_stats.usage) sort(desc)", "description": "Docker: Most memory by container", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "groupby(name) calculate(average:stats.cpu_stats.cpu_usage.total_usage) sort(desc)", "description": "Docker: Most CPU by container", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "calculate(average:stats.memory_stats.usage) timeSlice(10m)", "description": "Docker: Total memory", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "calculate(average:stats.cpu_stats.cpu_usage.total_usage) timeSlice(10m)", "description": "Docker: Total CPU", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type='create') calculate(count)", "description": "Docker: Create events", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type='start') calculate(count)", "description": "Docker: Start events", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type='stop') calculate(count)", "description": "Docker: Stop events", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type='die') calculate(count)", "description": "Docker: Die events", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type='attach') calculate(count)", "description": "Docker: Attach events", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type='Kill') calculate(count)", "description": "Docker: Kill events", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(type) groupby(type) calculate(count)", "description": "Docker: Container events by type", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.rx_bytes!=null) calculate(average:stats.networks.eth0.rx_bytes)", "description": "Docker: Traffic rx_bytes", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.rx_packets!=null) calculate(average:stats.networks.eth0.rx_packets)", "description": "Docker: Traffic rx_packets", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.rx_errors!=null) calculate(average:stats.networks.eth0.rx_errors)", "description": "Docker: Traffic rx_errors", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.rx_dropped!=null) calculate(average:stats.networks.eth0.rx_dropped)", "description": "Docker: Traffic rx_dropped", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.tx_bytes!=null) calculate(average:stats.networks.eth0.tx_bytes)", "description": "Docker: Traffic tx_bytes", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.tx_packets!=null) calculate(average:stats.networks.eth0.tx_packets)", "description": "Docker: Traffic tx_packets", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.tx_errors!=null) calculate(average:stats.networks.eth0.tx_errors)", "description": "Docker: Traffic tx_errors", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(stats.networks.eth0.tx_dropped!=null) calculate(average:stats.networks.eth0.tx_dropped)", "description": "Docker: Traffic tx_dropped", "source": "rapid7/r7insight_analytic_packs/docker.json"},
  {"query": "where(service>0) calculate(AVERAGE:service)", "description": "Heroku service time", "source": "rapid7/r7insight_analytic_packs/heroku_apps.json"},
  {"query": "where(connect>0) calculate(AVERAGE:connect)", "description": "Heroku connect time", "source": "rapid7/r7insight_analytic_packs/heroku_apps.json"},
  {"query": "where(service>0) groupby(dyno) calculate(AVERAGE:service)", "description": "Heroku service time by dyno", "source": "rapid7/r7insight_analytic_packs/heroku_apps.json"},
  {"query": "where(connect>0) groupby(dyno) calculate(AVERAGE:connect)", "description": "Heroku connect time by dyno", "source": "rapid7/r7insight_analytic_packs/heroku_apps.json"},
  {"query": "where(bytes>0) calculate(AVERAGE:bytes)", "description": "Heroku request size", "source": "rapid7/r7insight_analytic_packs/heroku_apps.json"},
  {"query": "where(sc_status>0) Calculate(unique:c_ip)", "description": "Unique visitors count (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status!=404) GroupBy(c_ip) Calculate(count)", "description": "Page view distribution (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status>0) groupby(sc_status) calculate(count)", "description": "Status type distribution (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status>0) calculate(average:time_taken)", "description": "Average response time (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status>0) groupby(c_ip) calculate(average:time_taken)", "description": "Average response time per page (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status=404) Calculate(count)", "description": "404 error count (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status=404) Groupby(cs_uri_stem) Calculate(count)", "description": "404 URL distribution (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status=404) Groupby(c_ip) Calculate(count)", "description": "404 errors by IP (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(sc_status > 0) groupby(cs_User_Agent) calculate(COUNT)", "description": "User agent distribution (IIS)", "source": "rapid7/r7insight_analytic_packs/iis_json.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, (?P<time>\\d{1,})/) calculate(AVERAGE:time)", "description": "Time taken in milliseconds (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, \\d{1,}, (?P<bytes>\\d{1,}),/) calculate(AVERAGE:bytes)", "description": "Average bytes sent (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, \\d{1,}, \\d{1,}, \\d{1,}, (?P<status>\\d{3})/) groupby(status) calculate(COUNT)", "description": "Status codes distribution (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, \\d{1,}, \\d{1,}, \\d{1,}, \\d{3}, (?P<windows_status>\\d{1,})/) groupby(windows_status) calculate(COUNT)", "description": "Windows status codes (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, \\d{1,}, \\d{1,}, \\d{1,}, \\d{3}, \\d{1,}, (?P<request_type>\\w{1,4})/) groupby(request_type) calculate(COUNT)", "description": "Request types distribution (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, \\d{1,}, \\d{1,}, \\d{1,}, \\d{3}, \\d{1,}, \\w{1,4}, (?P<url>\\D{1,}),/) groupby(url) calculate(COUNT)", "description": "URLs accessed distribution (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, (?P<time>\\d{1,})/ AND /.jpg/) calculate(AVERAGE:time)", "description": "Time taken for JPG files (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, (?P<time>\\d{1,})/ AND /.gif/) calculate(AVERAGE:time)", "description": "Time taken for GIF files (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{3}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}\\, (?P<time>\\d{1,})/ AND /.pdf/) calculate(AVERAGE:time)", "description": "Time taken for PDF files (IIS regex)", "source": "rapid7/r7insight_analytic_packs/iis_regex.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|(?P<status>\\d{3})/) groupby(status) calculate(COUNT)", "description": "HTTP codes distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|\\d*\\|\\d*\\|(?P<ZoneUrl>\\S*)\\|MISS|HIT/ AND /\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|(?P<status>\\d{3})/ status=200) groupby(ZoneUrl) calculate(COUNT)", "description": "Zone URL with status 200 (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|(?P<bytesDelivered>\\d*)/) calculate(COUNT)", "description": "Bytes delivered (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|(?P<userID>\\d*)/) calculate(UNIQUE:userID)", "description": "Unique user IDs (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|(?P<userID>\\d*)/) groupby(userID) calculate(COUNT)", "description": "User IDs distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|\\d*\\|(?P<zoneID>\\d*)/) calculate(UNIQUE:zoneID)", "description": "Unique zone IDs (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|\\d*\\|(?P<zoneID>\\d*)/) groupby(zoneID) calculate(COUNT)", "description": "Zone IDs distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|\\d*\\|\\d*\\|(?P<ZoneUrl>\\S*)\\|MISS|HIT/) groupby(ZoneUrl) calculate(COUNT)", "description": "Zone URL distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}\\|\\d*\\|\\d*\\|\\d*\\|\\S*\\|(?P<CacheStatus>MISS|HIT)/) groupby(CacheStatus) calculate(COUNT)", "description": "Cache status distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\[.*\\]\\|\"(?P<referrer>\\S*)\"\\|/) groupby(referrer) calculate(COUNT)", "description": "Referrer distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\[.*\\]\\|\"\\S*\"\\|\"(?P<userAgent>.*)\"\\|/) groupby(userAgent) calculate(COUNT)", "description": "User agent distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where( /\\[.*\\]\\|\"\\S*\"\\|\".*\"\\|(?P<scheme>.*)\\|.*\\|.*\\|.*\\|.*\\|.*\\|.*\\|/) groupby(scheme) calculate(COUNT)", "description": "Scheme distribution HTTP/HTTPS (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where( /\\[.*\\]\\|\"\\S*\"\\|\".*\"\\|.*\\|(?P<CountryCode>.*)\\|.*\\|.*\\|.*\\|.*\\|.*\\|/) groupby(CountryCode) calculate(COUNT)", "description": "Country code distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where( /\\[.*\\]\\|\"\\S*\"\\|\".*\"\\|.*\\|.*\\|(?P<CountryName>.*)\\|.*\\|.*\\|.*\\|.*\\|/) groupby(CountryName) calculate(COUNT)", "description": "Country name distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where( /\\[.*\\]\\|\"\\S*\"\\|\".*\"\\|.*\\|.*\\|.*\\|(?P<CityName>.*)\\|.*\\|.*\\|.*\\|/) groupby(CityName) calculate(COUNT)", "description": "City name distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where( /\\[.*\\]\\|\"\\S*\"\\|\".*\"\\|.*\\|.*\\|.*\\|.*\\|.*\\|.*\\|.*\\|\"(?P<organization>.*)) groupby(organization) calculate(COUNT)", "description": "Organization distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(/\\|(?P<POP>.*)\\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\|\\d{3}/) groupby(POP)", "description": "POP distribution (KeyCDN)", "source": "rapid7/r7insight_analytic_packs/key_cdn.json"},
  {"query": "where(type=ANOM_ROOT_TRANS)calculate(count)", "description": "Actions taken by root or admin (Linux PCI)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where((type=ANOM_LOGIN_ACCT OR type=ANOM_LOGIN_FAILURES OR type=ANOM_LOGIN_LOCATION OR type=ANOM_LOGIN_SESSIONS OR type=ANOM_LOGIN_TIME) OR (USER_LOGIN AND failed) OR(LOGIN AND failed) OR (USER_AUTH AND failed), loose)groupby(type)calculate(count)", "description": "Invalid logical access attempts (Linux PCI, loose)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(type=ANOM_LOGIN_ACCT OR type=ANOM_LOGIN_FAILURES OR type=ANOM_LOGIN_LOCATION OR type=ANOM_LOGIN_SESSIONS OR type=ANOM_LOGIN_TIME OR type=CRYPTO_KEY_USER OR type=USER_ACCT OR type=USER_AUTH OR type=USER_CMD OR type=USER_LOGIN OR type=USER_ERR OR type=USER_LOGOUT)groupby(type)", "description": "Identification and auth by type (Linux PCI)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(DAEMON AND success, loose)groupby(pid)", "description": "Assessment logs initialization (Linux PCI)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(EXECVE, loose)calculate(count)", "description": "System level objects updates (Linux PCI)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(type=SYSCALL)groupby(comm)", "description": "Access to all audit trails (Linux PCI)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(AuditD)groupby(key)", "description": "Linux AuditD key distribution", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where((type=ANOM_LOGIN_ACCT OR type=ANOM_LOGIN_FAILURES OR type=ANOM_LOGIN_LOCATION OR type=ANOM_LOGIN_SESSIONS OR type=ANOM_LOGIN_TIME) OR (/USER_LOGIN/ AND /failed/) OR(/LOGIN/ AND /failed/) OR (/USER_AUTH/ AND /failed/))groupby(type)calculate(count)", "description": "Invalid logical access attempts (Linux PCI, regex variant)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(/DAEMON/ AND /success/)groupby(pid)", "description": "Initialization of assessment logs (Linux PCI, regex variant)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(/EXECVE/)calculate(count)", "description": "Creation/deletion of system level objects (Linux PCI, regex variant)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(asset_os_family=linux) groupby(asset)", "description": "FIM Events per Linux Asset", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(asset_os_family=linux) groupby(file_event)", "description": "FIM Events by Event Type (Linux)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(asset_os_family=linux) groupby(user)", "description": "FIM Events per User (Linux)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(asset_os_family=linux) groupby(process)", "description": "FIM Events by Process (Linux)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(asset_os_family=linux) groupby(file_name) limit(100)", "description": "FIM Events by File Name (Linux)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(asset_os_family=linux) calculate(COUNT)timeslice(1440m)", "description": "FIM Events per Day (Linux)", "source": "rapid7/r7insight_analytic_packs/linux_pci.json"},
  {"query": "where(system>0) calculate(AVERAGE:system)", "description": "Total system CPU average", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(user>0) calculate(AVERAGE:user)", "description": "Total user CPU average", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(total>0) calculate(AVERAGE:total)", "description": "Total available memory", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(free>0) calculate(AVERAGE:free)", "description": "Memory free", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(active>0) calculate(AVERAGE:active)", "description": "Memory active", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(cached>0) calculate(AVERAGE:cached)", "description": "Memory cached", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(reads>0) calculate(AVERAGE:reads)", "description": "Disk reads per second", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(writes>0) calculate(AVERAGE:writes)", "description": "Disk writes per second", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(size>0) calculate(AVERAGE:size)", "description": "Disk size", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(used>0) calculate(AVERAGE:used)", "description": "Used disk", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(sshd session opened for user) calculate(COUNT)", "description": "SSH logins", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(sshd Invalid user) calculate(COUNT)", "description": "Failed SSH logins", "source": "rapid7/r7insight_analytic_packs/linux_server_monitoring.json"},
  {"query": "where(Executing command) calculate(COUNT)", "description": "Commands executed over time", "source": "rapid7/r7insight_analytic_packs/linux_syslog_ubuntu.json"},
  {"query": "where(/session opened for user (?P<user>.*) by/) groupby(user) calculate(COUNT)", "description": "User distribution (syslog)", "source": "rapid7/r7insight_analytic_packs/linux_syslog_ubuntu.json"},
  {"query": "where(authentication failure) calculate(COUNT)", "description": "Authentication failure count", "source": "rapid7/r7insight_analytic_packs/linux_syslog_ubuntu.json"},
  {"query": "where(pid) calculate(UNIQUE:pid)", "description": "Total unique processes", "source": "rapid7/r7insight_analytic_packs/linux_syslog_ubuntu.json"},
  {"query": "where(pid) groupby(pid) calculate(COUNT)", "description": "Process distribution by PID", "source": "rapid7/r7insight_analytic_packs/linux_syslog_ubuntu.json"},
  {"query": "where(/71 EVENT/) calculate(count)", "description": "DHCP scope modified", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where(/70 EVENT/) calculate(count)", "description": "DHCP scope configured", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where(/107 EVENT/) calculate(count)", "description": "DHCP reservation deleted", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where(/106 EVENT/) calculate(count)", "description": "DHCP reservation configured", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/70 EVENT/)", "description": "DHCP scope configured (search)", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/71 EVENT/)", "description": "DHCP scope modified (search)", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/72 EVENT/)", "description": "DHCP scope deleted", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/74 EVENT/)", "description": "DHCP scope deactivated", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/75 EVENT/)", "description": "DHCP scope updated", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/76 EVENT/)", "description": "DHCP scope updated with options", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/106 EVENT/)", "description": "DHCP reservation configured (search)", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/107 EVENT/)", "description": "DHCP reservation deleted (search)", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where (/119 EVENT/)", "description": "DHCP added exclusion range", "source": "rapid7/r7insight_analytic_packs/microsoft_dhcp.json"},
  {"query": "where(/[\\w+] (?P<databaseCommand>\\w+)/i databaseCommand=query OR databaseCommand=command) groupby(databaseCommand) calculate(COUNT)", "description": "MongoDB command vs query", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/command: (?P<command>\\w+)/i AND command!=isMaster AND command!=whatsmyuri) groupby(command) calculate(COUNT)", "description": "MongoDB database commands executed", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(reslen) calculate(AVERAGE:reslen)", "description": "MongoDB query result length in bytes", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/) groupby(component) calculate(COUNT)", "description": "MongoDB component distribution", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<sl> F | E | W | I | D )/) groupby(sl) calculate(COUNT)", "description": "MongoDB severity distribution", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=ACCESS) calculate(COUNT)", "description": "MongoDB ACCESS operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=COMMAND) calculate(COUNT)", "description": "MongoDB COMMAND operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=CONTROL) calculate(COUNT)", "description": "MongoDB CONTROL operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=GEO) calculate(COUNT)", "description": "MongoDB GEO operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=INDEX) calculate(COUNT)", "description": "MongoDB INDEX operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=NETWORK) calculate(COUNT)", "description": "MongoDB NETWORK operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=QUERY) calculate(COUNT)", "description": "MongoDB QUERY operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=REPL) calculate(COUNT)", "description": "MongoDB REPL operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=SHARDING) calculate(COUNT)", "description": "MongoDB SHARDING operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=STORAGE) calculate(COUNT)", "description": "MongoDB STORAGE operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=JOURNAL) calculate(COUNT)", "description": "MongoDB JOURNAL operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "where(/(?P<component>[A-Z]{3,8})/ component=WRITE) calculate(COUNT)", "description": "MongoDB WRITE operations", "source": "rapid7/r7insight_analytic_packs/mongodb3.0.json"},
  {"query": "groupby(http.status) calculate(COUNT:http.status)", "description": "HTTP codes distribution (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "groupby(http.path) calculate(COUNT:http.path)", "description": "URL distribution (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "calculate(AVERAGE:http.bytes)", "description": "Total bytes average (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "where(/\"GET .{1,}\\.php/) calculate(COUNT)", "description": "PHP requests count (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "where(/\"GET .{1,}\\.jpg/) calculate(COUNT)", "description": "JPG requests count (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "where(http.status) groupby(http.referer) calculate(COUNT:http.referer)", "description": "Referer distribution (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "groupby(http.agent) calculate(COUNT:http.agent)", "description": "User agent distribution (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "where(/\"GET .{1,}\\.php/i) calculate(COUNT)", "description": "PHP requests case-insensitive (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "where(/\"GET .{1,}\\.jpg/i) calculate(COUNT)", "description": "JPG requests case-insensitive (Nginx combined)", "source": "rapid7/r7insight_analytic_packs/nginx_combined.json"},
  {"query": "where(status>0) Calculate(unique:remote_addr)", "description": "Unique visitors count (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status!=404) GroupBy(request) Calculate(count)", "description": "Page view distribution (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status>0) groupby(status) calculate(count)", "description": "Status type distribution (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status>0) calculate(average:request_time)", "description": "Average response time (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status>0) groupby(request) calculate(average:request_time)", "description": "Average response time per page (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status>0) groupby(remote_addr) calculate(average:request_time)", "description": "Average response time by remote addr (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status>0) groupby(request) calculate(average:body_bytes_sent)", "description": "Average bytes sent per page (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status=404) Calculate(count)", "description": "404 error count (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status=404) Groupby(request) Calculate(count)", "description": "404 URL distribution (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(status>0) Groupby(http_user_agent) Calculate(count)", "description": "User agent distribution (Nginx JSON)", "source": "rapid7/r7insight_analytic_packs/nginx_json.json"},
  {"query": "where(Invalid credentials OR Certificate Verification: Error) calculate(count)", "description": "Puppet Console errors", "source": "rapid7/r7insight_analytic_packs/puppet_console.json"},
  {"query": "where(Could not retrieve catalog OR OutOfMemoryError) calculate(count)", "description": "Puppet Database errors", "source": "rapid7/r7insight_analytic_packs/puppet_database.json"},
  {"query": "where(No MCollective servers responded OR password is invalid OR Remote host closed connection) calculate(count)", "description": "Puppet Live Management errors", "source": "rapid7/r7insight_analytic_packs/puppet_live_management.json"},
  {"query": "where(Failed to generate additional resources OR Could not retrieve plugin OR Could not request certificate OR Name or service not known OR already initialized constant argv) calculate(count)", "description": "Puppet Master errors", "source": "rapid7/r7insight_analytic_packs/puppet_master.json"},
  {"query": "where(function_name) groupby(function_name) calculate(AVERAGE:execution_time)", "description": "Average execution time per method (Python APM)", "source": "rapid7/r7insight_analytic_packs/python_apm.json"},
  {"query": "where(function_name) groupby(function_name) calculate(AVERAGE:cpu)", "description": "Average CPU usage per method (Python APM)", "source": "rapid7/r7insight_analytic_packs/python_apm.json"},
  {"query": "where(function_name=function_two) calculate(AVERAGE:cpu)", "description": "Average CPU usage for specific method (Python APM)", "source": "rapid7/r7insight_analytic_packs/python_apm.json"},
  {"query": "where(LOGIN_EVENT) calculate(COUNT)", "description": "Salesforce logins", "source": "rapid7/r7insight_analytic_packs/salesforce.json"},
  {"query": "where(LOGOUT_EVENT) calculate(COUNT)", "description": "Salesforce logouts", "source": "rapid7/r7insight_analytic_packs/salesforce.json"},
  {"query": "where(LOGIN_AS_EVENT) calculate(COUNT)", "description": "Salesforce login-as events", "source": "rapid7/r7insight_analytic_packs/salesforce.json"},
  {"query": "where(/\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2}\\s(?P<hostname>.{1,15})\\s\\d{1}\\s(?P<eventcode>\\d{5})\\s/) groupby(eventcode)", "description": "SQL Server most frequent event codes", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2}\\s(?P<hostname>.{1,15})\\s\\d{1}\\s(?P<eventcode>\\d{5})\\s/) groupby(hostname)", "description": "SQL Server most active hosts", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/1 EVENT/)", "description": "SQL Server SQLVDI process aborted", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/101 EVENT/)", "description": "SQL Server Agent service started", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/102 EVENT/)", "description": "SQL Server Agent service stopped", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/103 EVENT/)", "description": "SQL Server Agent not started", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/53 EVENT/)", "description": "SQL Server Agent start failed", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/208 EVENT/)", "description": "SQL Server scheduled job message", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/324 EVENT/)", "description": "SQL Agent not allowed to run", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/1105 EVENT/)", "description": "SQL Server could not allocate space", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/3041 EVENT/)", "description": "SQL Server backup failed", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/9002 EVENT/)", "description": "SQL Server transaction log full", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/9003 EVENT/)", "description": "SQL Server log scan number invalid", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/12291 EVENT/)", "description": "SQL Server package failed", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/14151 EVENT/)", "description": "SQL Server replication agent failed", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17053 EVENT/)", "description": "SQL Server operating system error", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17113 EVENT/)", "description": "SQL Server file open error", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17187 EVENT/)", "description": "SQL Server not ready", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17207 EVENT/)", "description": "SQL Server operating system error (17207)", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17806 EVENT/)", "description": "SQL Server SSPI handshake failed", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17832 EVENT/)", "description": "SQL Server login packet invalid", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/17836 EVENT/)", "description": "SQL Server unexpected payload packet size", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/18056 EVENT/)", "description": "SQL Server client unable to reuse session", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/18204 EVENT/)", "description": "SQL Server cannot find specified path", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/18210 EVENT/)", "description": "SQL Server write failure on backup device", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/18452 EVENT/)", "description": "SQL Server login failed", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/18456 EVENT/)", "description": "SQL Server login failed for user", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/18483 EVENT/)", "description": "SQL Server could not connect to server", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/19019 EVENT/)", "description": "SQL Server MSSQLSERVER service terminated", "source": "rapid7/r7insight_analytic_packs/sql_server.json"},
  {"query": "where(/3041 EVENT/) calculate(count)", "description": "SQL Server failed backups count", "source": "rapid7/r7insight_analytic_packs/sql_server.json"}
]
