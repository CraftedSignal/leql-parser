[
  {"query": "where(result AND result != SUCCESS) groupby(destination_user) calculate(count)", "description": "Failed authentication by user"},
  {"query": "where(result ISTARTS-WITH \"FAILED\") groupby(destination_user) calculate(count)", "description": "Failed auth alternative"},
  {"query": "groupby(source_user)", "description": "Admin actions by user"},
  {"query": "groupby(action)", "description": "All admin actions"},
  {"query": "where(source_user=\"Arnold Holt\")", "description": "Activity by specific user"},
  {"query": "where(source_user=NOCASE(\"arnold holt\"))", "description": "Case-insensitive user search"},
  {"query": "where(source_user ICONTAINS admin) groupby(source_user)", "description": "Users with admin in name"},
  {"query": "where(source_user ICONTAINS admin) groupby(action)", "description": "Admin actions grouped"},
  {"query": "where(source_user ICONTAINS admin AND action=MEMBER_ADDED_TO_SECURITY_GROUP) groupby(group)", "description": "Admin group additions"},
  {"query": "where(action=\"MEMBER_ADDED_TO_SECURITY_GROUP\" AND group=\"vpn-users\") groupby(target_user)", "description": "Users added to group"},
  {"query": "where(action=\"MEMBER_ADDED_TO_SECURITY_GROUP\") groupby(source_user)", "description": "Accounts adding users to groups"},
  {"query": "where(action IN [MEMBER_ADDED_TO_SECURITY_GROUP, MEMBER_REMOVED_FROM_SECURITY_GROUP] AND group CONTAINS -job-admins)", "description": "Group changes tracking"},
  {"query": "where(severity ICONTAINS \"MALICIOUS\") groupby(asset) having(count>=5)", "description": "Malicious alerts by asset"},
  {"query": "groupby(logon_type)", "description": "All authentication types"},
  {"query": "groupby(result)", "description": "All authentication results"},
  {"query": "where(result AND result != SUCCESS) groupby(destination_user) calculate(count)", "description": "Failed authentication activity"},
  {"query": "where(service NOT IIN [\"krbtgt\", \"kerberos\"] AND result ISTARTS-WITH \"failed\") groupby(destination_account)", "description": "Non-Kerberos failed logins"},
  {"query": "where(service NOT IN [krbtgt, kerberos] AND result=\"FAILED_BAD_PASSWORD\") groupby(\"destination_asset\")", "description": "Non-Kerberos logins by asset"},
  {"query": "where(result ISTARTS-WITH \"FAILED\") groupby(destination_user)", "description": "Failed authentication accounts"},
  {"query": "groupby(source_json.Workload, action)", "description": "Workloads and actions"},
  {"query": "groupby(source_user) calculate(count) limit(10)", "description": "Top 10 Office365 users"},
  {"query": "where(public_suffix AND public_suffix NOT IN [com, net, org]) groupby(public_suffix)", "description": "Websites outside common domains"},
  {"query": "where(public_suffix=\"ru\") groupby(query)", "description": "Russian websites visited"},
  {"query": "where(process.exe_file.description ICONTAINS-ANY [\"ssh\", \"telnet\"]) groupby(process.name, hostname, process.username)", "description": "SSH/Telnet processes"},
  {"query": "where(user=\"Pete Coors\") groupby(file_name)", "description": "Files accessed by user"},
  {"query": "where(file_name=\"audit.csv\") groupby(user)", "description": "Users accessing file"},
  {"query": "where(incoming_bytes>0 AND geoip_country_code NOT IN [US, IE, GB, DE, JP, CA, AU]) groupby(geoip_country_code)", "description": "Downloads from non-US countries"},
  {"query": "where(geoip_country_name!=\"United States\") groupby(geoip_country_name)", "description": "Traffic from non-US"},
  {"query": "calculate(count)", "description": "Firewall log count"},
  {"query": "where(direction=OUTBOUND AND geoip_country_code!=US) groupby(destination_address) calculate(sum:outgoing_bytes) limit(10)", "description": "Top external data transfers"},
  {"query": "where(direction=INBOUND) groupby(destination_address) calculate(sum:incoming_bytes) limit(10)", "description": "Top inbound receivers"},
  {"query": "where(direction=\"OUTBOUND\" AND destination_address=\"52.205.169.150\") groupby(user)", "description": "Users accessing destination"},
  {"query": "where(connection_status=\"DENY\") calculate(count)", "description": "Denied connections"},
  {"query": "where(direction=\"OUTBOUND\" AND connection_status=\"DENY\") calculate(count)", "description": "Denied outbound traffic"},
  {"query": "where(connection_status=\"ACCEPT\" AND direction=\"OUTBOUND\" AND destination_port NOT IN [\"443\", \"80\", \"53\"]) groupby(destination_port)", "description": "Outbound ports excluding common"},
  {"query": "where(direction=OUTBOUND) groupby(destination_address) calculate(sum:outgoing_bytes)", "description": "Top outbound destinations"},
  {"query": "where(direction=INBOUND) groupby(source_address) calculate(sum:incoming_bytes)", "description": "Top inbound sources"},
  {"query": "where(geoip_country_name IN [Czechia, Russia, \"Hong Kong\"] AND connection_status=ACCEPT AND direction=INBOUND) groupby(geoip_country_name)", "description": "Allowlisted countries"},
  {"query": "where(connection_status=DENY AND source_address NOT IN [IP(10.0.0.0/8), IP(172.27.0.0/16), IP(169.254.0.0/16), IP(192.168.0.0/16), IP(172.16.0.0/16)])", "description": "External firewall denials"},
  {"query": "where(user!=\"unknown\" AND connection_status=DENY AND source_address NOT IN [IP(10.0.0.0/8), IP(172.27.0.0/16), IP(169.254.0.0/16), IP(192.168.0.0/16), IP(172.16.0.0/16)])", "description": "Known users with denies"},
  {"query": "where(connection_status=\"DENY\" AND geoip_country_name!=\"United States\") groupby(geoip_country_name) calculate(count)", "description": "Invalid connections non-US"},
  {"query": "where(connection_status=DENY AND direction=INBOUND AND geoip_country_name!=\"United States\") groupby(geoip_country_name) calculate(count)", "description": "Inbound denies by country"},
  {"query": "where(direction=\"OUTBOUND\" AND outgoing_bytes>50000000 AND geoip_organization=\"Box.com\")", "description": "Large Box.com transfers"},
  {"query": "where(action=\"OBTAIN\") groupby(asset) calculate(unique:ip) having(unique:ip>=5)", "description": "Assets with multiple IPs"},
  {"query": "where(severity=\"INFORMATIONAL\") groupby(signature) limit(1000)", "description": "Informational alerts"},
  {"query": "where(severity=\"LOW\") groupby(description)", "description": "Low severity alerts"},
  {"query": "groupby(severity) calculate(unique:signature)", "description": "Alerts by severity"},
  {"query": "where(severity=\"HIGH\") groupby(asset) calculate(unique:signature)", "description": "High severity by asset"},
  {"query": "where(severity=\"CRITICAL\") groupby(asset) calculate(unique:signature)", "description": "Critical severity by asset"},
  {"query": "where(geoip_country_name=\"United States\") calculate(count)", "description": "Users from specific country"},
  {"query": "where(geoip_country_name=\"United States\") groupby(user) calculate(count)", "description": "Users by country"},
  {"query": "where(geoip_city=\"San Jose\") groupby(user)", "description": "Users from specific city"},
  {"query": "where(geoip_country_name=\"Russia\")", "description": "Ingress from Russia"},
  {"query": "where(service=\"box\") groupby(user)", "description": "Users by service"},
  {"query": "where(service=\"o365\") groupby(user)", "description": "Office365 access"},
  {"query": "where(geoip_country_code!=\"US\") groupby(geoip_country_name)", "description": "Non-US access"},
  {"query": "where(result=SUCCESS) groupby(service, geoip_country_name, user_agent)", "description": "Successful auth details"},
  {"query": "where(status>=300) groupby(status) calculate(count) sort(desc) limit(350)", "description": "Status codes over 300"},
  {"query": "where(result=FAILED_BAD_PASSWORD) groupby(user) having(count>5)", "description": "Brute force detection"},
  {"query": "where(status=404) calculate(count) timeslice(30m)", "description": "404 errors over time"},
  {"query": "where(direction=\"OUTBOUND\" AND app_protocol_description ISTARTS-WITH \"TLS\") groupby(app_protocol_description)", "description": "TLS protocol versions"},
  {"query": "where(result=SUCCESS) groupby(service)", "description": "Successful SSO by service"},
  {"query": "where(severity=\"High\") groupby(type, title)", "description": "High severity alerts"},
  {"query": "groupby(header.name)", "description": "CyberArk activity"},
  {"query": "groupby(header.device_event_class_id)", "description": "CyberArk events by ID"},
  {"query": "groupby(header.severity)", "description": "Activity by severity"},
  {"query": "groupby(source_json.eventCode)", "description": "Windows Defender event codes"},
  {"query": "where(source_json.eventCode=1116) groupby(user, asset, file_path)", "description": "Malware/PUP detection"},
  {"query": "groupby(risk)", "description": "All risks"},
  {"query": "calculate(count) timeslice(1d)", "description": "Risk count trend"},
  {"query": "groupby(source_json.Category, source_json.Severity)", "description": "Categories and severity"},
  {"query": "where(is_blocked=true) calculate(count)", "description": "Blocked URLs count"},
  {"query": "where(process.name=NOCASE(taskkill.exe)) groupby(process.cmd_line)", "description": "Taskkill commands"},
  {"query": "where(connection_status=DENY) groupby(source_address)", "description": "Denies grouped by host"},
  {"query": "where(result=FAILED_BAD_LOGIN) calculate(UNIQUE:source_ip)", "description": "Unique failed IPs"},
  {"query": "where(service=o365 AND result=FAILED_BAD_LOGIN) groupby(source_ip)", "description": "Office365 failures"},
  {"query": "where(geoip_country_code!=US) groupby(geoip_country_name) sort(desc)", "description": "Country filtering"},
  {"query": "where(result=SUCCESS AND geoip_country_name=\"United States\") calculate(count) timeslice(1h)", "description": "Weekly US auth"},
  {"query": "where(result=SUCCESS AND geoip_country_name!=\"United States\") calculate(count) timeslice(1d)", "description": "Weekly auth failures"},
  {"query": "select(hostname, process.name) where(process.name=NOCASE(powershell.exe))", "description": "Select with where"},
  {"query": "where(EventCode=4688)", "description": "Windows process creation"},
  {"query": "where(EventID=4624)", "description": "Windows successful logon"},
  {"query": "where(destination_user ICONTAINS admin) groupby(destination_user, result)", "description": "Admin user auth results"},
  {"query": "where(source_address=IP(10.0.0.0/8)) groupby(source_address)", "description": "Internal network traffic"},
  {"query": "where(process.exe_file.hashes.md5=\"d41d8cd98f00b204e9800998ecf8427e\")", "description": "Process by MD5 hash"},
  {"query": "where(destination_port=22) groupby(source_address, destination_address)", "description": "SSH connections"},
  {"query": "where(destination_port=3389) groupby(source_address, destination_address)", "description": "RDP connections"},
  {"query": "where(protocol=UDP AND destination_port=53) groupby(source_address)", "description": "DNS traffic by source"},
  {"query": "where(source_json.AccountType=\"User\") groupby(source_user)", "description": "User account type activity"},
  {"query": "where(action CONTAINS delete) groupby(source_user, action)", "description": "Delete actions by user"},
  {"query": "where(result=ACCOUNT_LOCKED_OUT) groupby(destination_user)", "description": "Locked out accounts"},
  {"query": "where(logon_type=10) groupby(destination_user, source_address)", "description": "Remote interactive logons"},
  {"query": "groupby(source_address) calculate(count) sort(desc) limit(20)", "description": "Top 20 source addresses"},
  {"query": "where(destination_port NOT IN [80, 443, 53, 8080]) groupby(destination_port) calculate(count) sort(desc)", "description": "Uncommon destination ports"},
  {"query": "where(severity IN [HIGH, CRITICAL]) groupby(asset, signature)", "description": "High and critical alerts by asset"},
  {"query": "where(geoip_country_code IN [CN, RU, KP, IR]) groupby(source_address, geoip_country_name)", "description": "Traffic from threat countries"},
  {"query": "where(process.cmd_line ICONTAINS \"whoami\") groupby(hostname, process.username)", "description": "Whoami command usage"},
  {"query": "where(process.cmd_line ICONTAINS \"net user\") groupby(hostname, process.username)", "description": "Net user command usage"},
  {"query": "where(file_name ICONTAINS \".exe\" AND user!=\"SYSTEM\") groupby(user, file_name)", "description": "Non-system exe file access"},
  {"query": "where(outgoing_bytes>100000000) groupby(source_address, destination_address)", "description": "Large outbound transfers"},
  {"query": "where(incoming_bytes>100000000) groupby(source_address, destination_address)", "description": "Large inbound transfers"}
]
