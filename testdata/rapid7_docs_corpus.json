[
  {"query": "where(result AND result != SUCCESS) groupby(destination_user) calculate(count)", "description": "All failed authentication activity, grouped by destination_user", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result ISTARTS-WITH \"FAILED\") groupby(destination_user) calculate(count)", "description": "All failed authentication activity (alternative using ISTARTS-WITH)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(source_user)", "description": "All users who completed an admin action", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(action)", "description": "All admin actions", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=\"Arnold Holt\")", "description": "All activity taken by a specific user (exact match)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=NOCASE(\"arnold holt\"))", "description": "All activity taken by a specific user (case-insensitive)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=\"Tina Gonzales (Admin)\")", "description": "Activity by user with parentheses in name", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=NOCASE(\"tina gonzales (admin)\"))", "description": "Activity by user with parentheses in name (case-insensitive)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=\"rrn:uba:us:14f8eba8-46c8-474b-a982-29476e7a8bd8:user:JA5G9PI3PC9M\")", "description": "Activity by RRN (Rapid7 Resource Name) identifier", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user ICONTAINS admin)groupby(source_user)", "description": "All users with admin in their user name", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user ICONTAINS admin)groupby(action)", "description": "All admin user actions grouped by action type", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user ICONTAINS admin AND action=MEMBER_ADDED_TO_SECURITY_GROUP) groupby(group)", "description": "All groups that a user was added to by someone with admin in their name", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action=\"MEMBER_ADDED_TO_SECURITY_GROUP\" AND group=\"vpn-users\")groupby(target_user)", "description": "All users added to a particular group", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action=\"MEMBER_ADDED_TO_SECURITY_GROUP\")groupby(source_user)", "description": "Accounts that added users to groups", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(target_account NOT ICONTAINS \"$\" AND action=PRIVILEGE_ESCALATION)groupby(target_account, group, source_user, timestamp)", "description": "Accounts (DN display) that had privileges escalated, to what group, by whom, on what day/time", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action IN [MEMBER_ADDED_TO_SECURITY_GROUP, MEMBER_REMOVED_FROM_SECURITY_GROUP] AND group CONTAINS -job-admins)", "description": "Group changes made to a certain group", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4732 EVENT/ OR /\\s636 EVENT/) groupby(host)", "description": "Admin account created by host (regex extraction)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4740 EVENT/ OR /\\s644 EVENT/) groupby(host)", "description": "Accounts locked out by host (regex extraction)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/:\\d{2} (?P<host>\\w+)./ AND /1102 EVENT/ OR /\\s517 EVENT/) groupby(host)", "description": "Audit Log cleared by Host (regex extraction)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/4719 EVENT/ OR /\\s612 EVENT/)", "description": "Audit Policy Changed", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/eventCode\\\\\":(?P<EVID>\\d{4})/) groupby(EVID)", "description": "All Microsoft Event IDs for collected events (unquoted eventCode)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/eventCode\\\\\":\\\\\"(?P<EVID>\\d{4})/)groupby(EVID)", "description": "All Microsoft Event IDs for collected events (quoted eventCode)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/computerName\\\\\":\\\\\"(?P<HostName>[\\w\\d\\-]*)/)groupby(HostName)", "description": "All hosts that logs have been collected from (regex)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity ICONTAINS \"MALICIOUS\")groupby(asset)having(count>=5)", "description": "All MALICIOUS Advanced Malware Alerts, grouped by assets with 5+ alerts", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(logon_type)", "description": "All authentication types", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(result)", "description": "All authentication results", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/(?P<ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})/) groupby(ip) calculate(count)", "description": "All failed Logins by IP (regex IP extraction)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(service NOT IIN [\"krbtgt\", \"kerberos\"] AND result ISTARTS-WITH \"failed\") groupby(destination_account)", "description": "All failed Non-Kerberos logins", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(service NOT IN [krbtgt, kerberos] AND result=\"FAILED_BAD_PASSWORD\")groupby(\"destination_asset\")", "description": "All Non-Kerberos logins by destination asset", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result ISTARTS-WITH \"FAILED\")groupby(destination_user)", "description": "All accounts attempting to authenticate that failed", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/4625 EVENT/ OR /\\s529 EVENT/)", "description": "All invalid logins (Windows event log)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4625 EVENT/ OR /\\s529 EVENT/) groupby(host)", "description": "All invalid logins by host (regex extraction)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(access_method=\"web\")groupby(action)", "description": "All investigation activity from SIEM Platform, grouped by action", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action=\"INVESTIGATION_CLOSED\")groupby(request.user.name)", "description": "All analysts who closed an investigation, grouped by user name", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(service_info.investigation_type=\"MANUAL\")groupby(service_info.investigation_name)limit(1000)", "description": "Manually created investigations, grouped by alert name", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action=\"INVESTIGATION_DATA_ADDED\")groupby(service_info.investigation_type, service_info.data_type)", "description": "All instances where data has been added to an investigation", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(source_json.Workload, action)", "description": "All Cloud Service Workloads and actions performed", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(source_user)calculate(count)limit(10)", "description": "Top 10 users with the most Office365 activity", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action=CREATE_USER AND target_user=/.*\\#EXT\\#.*/i) groupby(source_user, target_user)", "description": "Office365 guest account creations and who created them", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=/.*\\#EXT\\#.*/i)groupby(source_json.Workload)", "description": "Office365 guest account areas of activity", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=/.*\\#EXT\\#.*/i AND source_json.Workload=SharePoint)groupby(action)", "description": "Office365 guest account SharePoint actions", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=/.*\\#EXT\\#.*/i AND source_json.Workload=OneDrive AND action=/FileDownloaded|FileAccessed/)groupby(action, source_json.SourceFileName)", "description": "Office365 guest account OneDrive files downloaded or accessed", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_user=/.*\\#EXT\\#.*/i AND source_json.Workload=MicrosoftTeams AND action=/TeamsSessionStarted/i)groupby(source_user)", "description": "Office365 guest account Team Sessions started", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(public_suffix AND public_suffix NOT IN [com, net, org])groupby(public_suffix)", "description": "All websites visited outside .com, .net, and .org domains", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(public_suffix=\"ru\")groupby(query)", "description": "All websites in Russia visited by users", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/facebook/ AND user!=\"unknown\")calculate(count)", "description": "Count of users who accessed Facebook", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/dropbox/ AND user!=\"unknown\")groupby(user)", "description": "All users who accessed Dropbox", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(/facebook/ AND user!=\"unknown\")groupby(user)", "description": "All users who accessed Facebook", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(process.name=/powershell.exe/i AND process.cmd_line NOT IN [\"null\", /.*ps1.*/i])groupby(process.cmd_line)", "description": "All child Powershell process command lines that are not empty or only running a ps1 script", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(process.exe_file.description)", "description": "All processes by file descriptions", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(process.hash_reputation.reputation)", "description": "All process reputations", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(process.name=NOCASE(taskkill.exe)) groupby(process.cmd_line)", "description": "All command lines showing the taskkill.exe process", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(process.exe_file.description icontains-any [\"ssh\", \"telnet\"]) groupby(process.name, hostname, process.username)", "description": "All processes, hostnames, and users running SSH and/or Telnet", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(user=\"Pete Coors\")groupby(file_name)", "description": "All files accessed by a specific user", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(file_name=\"audit.csv\")groupby(user)", "description": "All users who accessed a specific file", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(query=\"safebrowsing.google.com\" AND user!=\"unknown\")groupby(user)limit(20)", "description": "Top 20 known users accessing Safebrowsing", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(file_event=\"delete\" OR \"write\" OR \"modify\") calculate(count)", "description": "All log entries where FIM events are logged", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(incoming_bytes>0 AND geoip_country_code NOT IN [US, IE, GB, DE, JP, CA, AU])groupby(geoip_country_code)", "description": "All countries that users have downloaded data from", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_name!=\"United States\")groupby(geoip_country_name)", "description": "All firewall traffic from countries other than the United States", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "calculate(count)", "description": "A count of all firewall logs", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=OUTBOUND AND geoip_country_code!=US)groupby(destination_address)calculate(sum:outgoing_bytes)limit(10)", "description": "Top 10 external systems outside US receiving the most data", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=INBOUND)groupby(destination_address)calculate(sum:incoming_bytes)limit(10)", "description": "Top 10 internal systems receiving the most data", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=\"OUTBOUND\" AND destination_address=\"52.205.169.150\")groupby(user)", "description": "All users accessing a particular destination", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(connection_status=\"DENY\") calculate(count)", "description": "All countries with a connection status of deny", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=\"OUTBOUND\" AND connection_status=\"DENY\")calculate(count)", "description": "All denied outbound traffic", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(connection_status=\"ACCEPT\" AND direction=\"OUTBOUND\" AND destination_port NOT IN [\"443\", \"80\", \"53\"]) groupby(destination_port)", "description": "All used outbound ports except for 443, 80, and 53", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=OUTBOUND)groupby(destination_address)calculate(sum:outgoing_bytes)", "description": "Top outbound destinations by bytes", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=INBOUND)groupby(source_address)calculate(sum:incoming_bytes)", "description": "Top inbound destinations by bytes", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_name IN [Czechia, Russia, \"Hong Kong\"] AND connection_status = ACCEPT AND direction=INBOUND)groupby(geoip_country_name)", "description": "Allowlisted countries with accepted inbound connections", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(connection_status = DENY AND source_address NOT IN [IP(10.0.0.0/8),IP(172.27.0.0/16),IP(169.254.0.0/16),IP(192.168.0.0/16),IP(172.16.0.0/16)])", "description": "External firewall denials by subnet (excluding private IPs)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(user!=\"unknown\" AND connection_status = DENY AND source_address NOT IN [IP(10.0.0.0/8), IP(172.27.0.0/16), IP(169.254.0.0/16), IP(192.168.0.0/16), IP(172.16.0.0/16)])", "description": "All known users with deny status from external IPs", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(connection_status=\"DENY\" AND geoip_country_name!=\"United States\") groupby(geoip_country_name) calculate(count)", "description": "All invalid connection attempts from non-US countries", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(connection_status=DENY AND direction=INBOUND AND geoip_country_name!=\"United States\") groupby(geoip_country_name) calculate(count)", "description": "All inbound denies by country", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=\"OUTBOUND\" AND outgoing_bytes>50000000 AND geoip_organization=\"Box.com\")", "description": "All data transmissions greater than 50MB to Box.com", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(stats.networks.eth0.rx_bytes!=null) calculate(average:stats.networks.eth0.rx_bytes)", "description": "All Docker traffic (RAW) received in bytes", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(action=\"OBTAIN\")groupby(asset)calculate(unique:ip)having(unique:ip>=5)", "description": "All assets that have obtained more than 5 unique IP addresses", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity=\"INFORMATIONAL\")groupby(signature)limit(1000)", "description": "Informational alerts by signature", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity=\"INFORMATIONAL\" AND signature=/.*ssh.*/i)groupby(signature)", "description": "All informational alerts with SSH signatures", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity=\"LOW\")groupby(description)", "description": "All low severity alerts grouped by description", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(severity)calculate(unique:signature)", "description": "All alerts grouped by severity with unique signatures", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity=\"HIGH\")groupby(asset)calculate(unique:signature)", "description": "All high severity alerts grouped by asset with unique signatures", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity=\"CRITICAL\")groupby(asset)calculate(unique:signature)", "description": "All critical severity alerts grouped by asset with unique signatures", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_name=\"United States\")calculate(count)", "description": "All events where user logged in from US (count)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_name=\"United States\")groupby(user)calculate(count)", "description": "All events from US grouped by user with count", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_city=\"San Jose\")groupby(user)", "description": "All users accessing the network from a specific city", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_city=/Providence|Framingham|Dallas|Minneapolis|Appleton|Phoenix|Omaha|Melbourne|Tuzla|Leeds|Zurich|Singapore|Toronto/i)groupby(geoip_city)", "description": "All users accessing the network from a list of cities (regex alternation)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_name=\"Russia\")", "description": "All ingress from Russia", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(service=\"box\")groupby(user)", "description": "All users accessing network from Box service", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(service=\"o365\")groupby(user)", "description": "All users accessing network from Office365 service", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_code!=\"US\") groupby(geoip_country_name)", "description": "All users accessing network from countries other than US", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(geoip_country_name AND geoip_country_name!=/United States|Canada|Mexico/i AND result=SUCCESS)groupby(geoip_country_name)limit(100)", "description": "All countries with successful authentication outside North America", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result=SUCCESS)groupby(service, geoip_country_name, user_agent)", "description": "All successful ingress authentications by service, country, and user agent", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result=SUCCESS AND geoip_country_name=\"United States\")calculate(count)timeslice(1h)", "description": "Weekly US ingress authentications - success (hourly)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result=/failed.*/i AND geoip_country_name=\"United States\")calculate(count)timeslice(1h)", "description": "Weekly US ingress authentications - failure (hourly)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result=SUCCESS AND geoip_country_name!=\"United States\")calculate(count)timeslice(1d)", "description": "Weekly non-US ingress authentications - success (daily)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(result=/failed.*/i AND geoip_country_name!=\"United States\")calculate(count)timeslice(1d)", "description": "Weekly non-US ingress authentications - failure (daily)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.operationName=\"Sign-in activity\" AND result=SUCCESS)groupby(source_json.properties.appDisplayName)", "description": "All apps being successfully signed into", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.operationName=\"Sign-in activity\" AND result=FAILED_ACCOUNT_DISABLED)groupby(user)", "description": "All users who attempted sign in but failed due to disabled account", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.properties.riskLevelDuringSignIn!=none)groupby(\"source_json.properties.riskLevelDuringSignIn\")", "description": "All sign-in risk levels", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(source_json.properties.mfaDetail.authMethod)", "description": "Azure MFA Methods Used", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.properties.mfaDetail.authMethod=/Text message/i)groupby(result)", "description": "Azure MFA Text Message Notifications grouped by result", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.properties.mfaDetail.authMethod=/Mobile app verification code/i)groupby(result)", "description": "Azure Mobile app Verification Code Results", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.properties.mfaDetail.authMethod=/Phone call \\(Authentication phone\\)/i)groupby(result)", "description": "All failed Azure MFA phone calls grouped by result", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.properties.mfaDetail.authMethod=\"OATH verification code\")groupby(result)", "description": "All Azure MFA OATH verification codes grouped by result", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(direction=\"OUTBOUND\" AND app_protocol_description ISTARTS-WITH \"TLS\")groupby(app_protocol_description)", "description": "All TLS protocol versions in outbound Network Flow logs", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.outcome.result=SUCCESS)groupby(service)", "description": "All successful single-service sign-ons grouped by service", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(severity=\"High\")groupby(type, title)", "description": "All high severity Third Party Alerts, grouped by alert type and title", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(header.name)", "description": "All CyberArk activity", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(header.device_event_class_id)", "description": "All CyberArk events by ID", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(header.severity)", "description": "All activity grouped by severity", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(source_json.eventCode)", "description": "All Windows Defender event codes", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(source_json.eventCode=1116)groupby(user, asset, file_path)", "description": "All events where malware or PUP was detected, grouped by user, asset, and file path", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(risk)", "description": "All risks (alerts)", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "calculate(count)timeslice(1d)", "description": "All risk counts trend by day", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "groupby(source_json.Category, source_json.Severity)", "description": "All categories and severity", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(is_blocked=true)calculate(count)", "description": "All blocked URLs counter", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(is_blocked=true)groupby(source_json.sender)calculate(unique:source_json.sender)", "description": "All blocked URLs grouped by unique sender", "source": "https://docs.rapid7.com/insightidr/example-queries/"},
  {"query": "where(data.logName ICONTAINS \"SECURITY\")groupby(data.eventCode)", "description": "All Windows Security event logs grouped by event code", "source": "https://docs.rapid7.com/insightidr/example-queries/"},

  {"query": "dessert=\"banana pudding\"", "description": "Basic key-value pair search with quoted value containing spaces", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key = \"banana ' pudding\")", "description": "Quoted values with apostrophes using double quotes", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key = 'banana \" pudding')", "description": "Quoted values with double quotes using single quotes", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key = '''banana \" pudding''')", "description": "Triple quotes for values with mixed punctuation", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key = '''banana ' apple \" pudding''')", "description": "Triple quotes for values with both single and double quotes", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key NOT IN [\"aaa\", \"bbb\"])", "description": "NOT with IN operator to exclude results", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key1, key2 NOT STARTS-WITH \"aaa\")", "description": "NOT with STARTS-WITH on compound keys", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(all(key1, key2) IN [value1, value2])", "description": "ALL function for compound key AND logic", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where((city = London OR city = Dublin) AND action = login)", "description": "Operator precedence with parentheses to override AND/OR", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(run)", "description": "Keyword search for delimited word", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(Amazon AND Boardman)", "description": "Multiple keywords with AND operator", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(\"Amazon Boardman\")", "description": "Exact phrase search with quotation marks", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(/complete/)", "description": "Regex search - partial match (matches complete, completely, completed)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(/error/i)", "description": "Case-insensitive regex search", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key = NOCASE(value))", "description": "NOCASE function for case-insensitive matching", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key ICONTAINS value)", "description": "Case-insensitive substring search on field", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(user=admin, loose)", "description": "Loose search for quick case-insensitive and partial matching", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key1==key2, loose)", "description": "Loose key-to-key comparison (case-insensitive)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(date=/05\\/\\d{2}\\/2023/)", "description": "Regex with escaped forward slashes for date matching", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(/Client=(?P<source_address>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})/) groupby(source_address) calculate(count)", "description": "Named capturing group for IP address extraction with groupby", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(/total sale (?P<saleValue>\\d*)/)", "description": "Named capturing group to extract numeric values", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(/total sale (?P<saleValue>\\d*)/) calculate(average:saleValue)", "description": "Calculate average on regex-extracted named group", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(response_time>25)", "description": "KVP numeric comparison (greater than)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(response_time>25 OR containerID=14)", "description": "Combining conditions with OR logic", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(path=C:\\\\Windows)", "description": "Windows path search with escaped backslash", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(path=\"C:\\Windows\")", "description": "Windows path search with quoted string", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(destination_address = IP(192.168.0.0/24))", "description": "CIDR notation search for IP range (/24 subnet)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(destination_address = IP(192.168.0.0/16))", "description": "CIDR notation search for broader IP range (/16 subnet)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "groupby(destination_user) calculate(count)", "description": "Groupby with count calculation", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "groupby(destination_user, result, service, source_asset_address) calculate(count)", "description": "Multi-field groupby with count", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(result=FAILED_BAD_PASSWORD) groupby(user)", "description": "Basic groupby for failed password attempts", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(result=FAILED_BAD_PASSWORD) groupby(user) having (count>15)", "description": "Having clause to filter groups by count threshold", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(result = FAILED_BAD_PASSWORD) groupby(user) calculate(unique:geoip_country_name) having(unique:geoip_country_name>1)", "description": "Having clause with unique calculation", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "groupby(#log) calculate(bytes)", "description": "Groupby log source with bytes calculation", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(status=500) calculate(COUNT)", "description": "Count of 500 status errors", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(total_bytes>2000) calculate(SUM:total_bytes)", "description": "Sum of total bytes above threshold", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(total_bytes>0) calculate(AVERAGE:total_bytes)", "description": "Average of total bytes", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(userID) calculate(UNIQUE:userID)", "description": "Unique count of user IDs", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(status=200) calculate(MIN:responseTime)", "description": "Minimum response time for successful requests", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(status=200) calculate(Max:responseTime)", "description": "Maximum response time for successful requests", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(status=404) calculate(count) timeslice(60)", "description": "Timeslice with 60 equal intervals", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(status=404) calculate(count) timeslice(30m)", "description": "Timeslice with 30-minute intervals", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "calculate(pctl(95):total)", "description": "95th percentile calculation to exclude outliers", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "calculate(standarddeviation:outgoing_bytes)", "description": "Standard deviation of outgoing bytes", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "calculate(sd:outgoing_bytes)", "description": "Standard deviation shorthand (sd keyword)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(\"action\" = \"ACCOUNT_CREATED\") limit(5)", "description": "Limit results to 5 most recent matches", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "groupby(source_asset_address) calculate(count) sort(desc) limit(350)", "description": "Groupby with sort and limit of 350 groups", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "groupby(source_asset_address, service) calculate(count) sort(desc) limit(100, 20)", "description": "Multi-field groupby with different limits per field", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "select(hostname as host, process.name as process, \"process.exe_file.hashes.sha256\" as sha256hash) where(\"suspicious event\")", "description": "Select clause with field renaming (as keyword)", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "select(username as user, hostname as host) where(login!=success)", "description": "Select with filtering condition", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(key1,key2 = \"abc\")", "description": "Compound keys with comma acting as OR", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},
  {"query": "where(source_address IN [IP(10.0.0.0/24), IP(192.168.0.0/24)])", "description": "IN operator with IP CIDR notation", "source": "https://docs.rapid7.com/insightidr/build-a-query/"},

  {"query": "where(powershell)", "description": "Basic keyword search (case sensitive)", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(\"powershell.exe\")", "description": "Quoted string search ignoring period as special character", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(/pass{2,5}word/)", "description": "Regex with quantifier matching character repetition", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(/w{3}/)", "description": "Regex matching three consecutive w characters", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(event_code IN [\"1\", \"2\", \"3\"])", "description": "IN operator with string array", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(event_code=/467./)", "description": "Regex wildcard matching on field value", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(/.*password.*/)", "description": "Regex matching password anywhere in log", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(result ISTARTS-WITH \"failed\") groupby(user)", "description": "Groupby with case-insensitive starts-with", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(result ISTARTS-WITH \"failed\") groupby(user) having(count>=5)", "description": "Having clause filtering groups with 5+ failures", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(result ISTARTS-WITH \"failed\") groupby(user)sort(dsc)", "description": "Sort descending on grouped results", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(result ISTARTS-WITH \"failed\") groupby(user) limit(10)", "description": "Limit output to 10 grouped results", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},
  {"query": "where(powershell) groupby(user) calculate(count)", "description": "Count powershell events grouped by user", "source": "https://docs.rapid7.com/insightidr/tips-and-tricks-for-building-queries/"},

  {"query": "where(result=FAILED_BAD_PASSWORD) groupby(user) having (count>5)", "description": "Filter to users with more than 5 failed login attempts", "source": "https://docs.rapid7.com/insightidr/search-your-logs/"},
  {"query": "groupby(destination_user, result) calculate(count) sort(asc, desc#key)", "description": "Multi-field groupby with multiple sort directions", "source": "https://docs.rapid7.com/insightidr/search-your-logs/"},

  {"query": "where(source_ip NOT IN [IP(10.0.0.0/8), IP(172.27.0.0/16), IP(169.254.0.0/16), IP(192.168.0.0/16), IP(172.16.0.0/16)])", "description": "Complex IP address filtering excluding private ranges", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(source_ip NOT IN [${private_ip}])", "description": "Variable-based private IP filtering", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(geoip_country_code NOT IN [\"CA\", \"US\", \"MX\"])", "description": "Regional filtering excluding North America", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(geoip_country_code NOT IN [${na_region}])", "description": "Variable-based regional filtering", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(connection_status = DENY and source_address not in [${private_ip_sample}])", "description": "Deny status with variable-based IP exclusion", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(geoip_country_code in [${eu_region_sample}])", "description": "EU region variable for geographic filtering", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(geoip_organization IIN [${low_cost_vpns_sample}])", "description": "Low-cost VPN detection using variable", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(process.exe_file.product_name IIN [${remote_access_solutions_sample}])", "description": "Remote access solutions detection using variable", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(process.exe_file.description IIN [${cloud_storage_solutions_sample}])", "description": "Cloud storage detection using variable", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(${single_low_cost_vpn})", "description": "Single-value variable as keyphrase search", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},
  {"query": "where(geoip_organization=${single_low_cost_vpn})", "description": "Single-value variable in key-value comparison", "source": "https://docs.rapid7.com/insightidr/use-variables-in-queries/"},

  {"query": "where(asset_os_family=windows) groupby(asset)", "description": "FIM Events per asset on Windows", "source": "https://docs.rapid7.com/insightidr/search-logs-for-fim-events/"},
  {"query": "where(asset_os_family=windows) groupby(file_name) limit(100)", "description": "FIM Events by file name on Windows", "source": "https://docs.rapid7.com/insightidr/search-logs-for-fim-events/"},
  {"query": "where(asset_os_family=windows) groupby(file_event)", "description": "FIM Events by event type on Windows", "source": "https://docs.rapid7.com/insightidr/search-logs-for-fim-events/"},
  {"query": "where(asset_os_family=windows AND file_name=<file name>) groupby(user)", "description": "FIM Events from a single file grouped by user", "source": "https://docs.rapid7.com/insightidr/search-logs-for-fim-events/"},
  {"query": "where(asset_os_family=windows AND file_name=<file name>) calculate(COUNT) timeslice(1440m)", "description": "FIM Events of a single file in one day (1440-minute timeslice)", "source": "https://docs.rapid7.com/insightidr/search-logs-for-fim-events/"},
  {"query": "where(asset_os_family=windows AND asset=<asset name>) groupby(process)", "description": "Processes on an asset by hostname", "source": "https://docs.rapid7.com/insightidr/search-logs-for-fim-events/"},

  {"query": "where(process.name=\"psexec.exe\" OR parent_process.name=\"psexec.exe\")groupby(hostname)calculate(unique:hostname)limit(1000)", "description": "PsExec detection (parent or child process)", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"psexecsvc.exe\" OR parent_process.name=\"psexecsvc.exe\")groupby(hostname)calculate(unique:hostname)", "description": "PsExecSvc detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"ping.exe\")groupby(hostname, process.cmd_line)", "description": "Ping process analysis by hostname and command line", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"netstat.exe\")groupby(hostname, process.cmd_line)", "description": "Netstat process analysis by hostname and command line", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.exe_file.signing_status.status=\"UNSIGNED\")groupby(process.name, hostname) calculate(count)", "description": "Unsigned Windows processes", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.cmd_line icontains \"keyword\")groupby(hostname, process.name)", "description": "Processes containing specific keywords in command line", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"mstsc.exe\")groupby(hostname, process.cmd_line)", "description": "Remote Desktop (RDP) usage detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"mmc.exe\")groupby(process.cmd_line)", "description": "Microsoft Management Console and associated commands", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"mmc.exe\" AND process.cmd_line icontains \"dsa.msc\")groupby(hostname, parent_process.username)", "description": "MMC launching Active Directory Users and Computers", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(\"mimikatz\", loose)groupby(hostname, parent_process.cmd_line)", "description": "Mimikatz detection with loose matching", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "groupby(process.name)calculate(unique:hostname)limit(1000)", "description": "Unique processes running on hosts", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"msiexec.exe\" AND process.cmd_line icontains \"/i\")groupby(process.cmd_line)", "description": "MSIExec installations", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"msiexec.exe\" AND process.cmd_line icontains \"/quiet\")groupby(process.cmd_line)", "description": "MSIExec quiet installations", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(os_type=\"LINUX\")groupby(process.exe_file.permission, process.name)", "description": "Linux process permissions grouped by file permission and name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.reputation='Known')groupby(process.name)", "description": "Known reputation processes by name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.reputation='Unknown')groupby(process.name)", "description": "Unknown reputation processes by name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.reputation='Malicious')groupby(process.name)", "description": "Malicious reputation processes by name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "groupby(process.hash_reputation.reliability)", "description": "Overall process reliability grouping", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.classification.type='PUA')groupby(process.name, process.hash_reputation.threat_level)", "description": "Potentially Unwanted Programs (PUPs) by name and threat level", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.classification.type='PUA')groupby(process.name, hostname, process.username)", "description": "PUPs by name, hostname, and username", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.classification.type='Adware')groupby(process.name)", "description": "Adware detection by process name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "groupby(process.hash_reputation.classification.type)", "description": "Classification types grouping", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.threat_level='Low')groupby(process.name)", "description": "Low threat level processes by name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.hash_reputation.reliability IN ['Very high', 'High'])groupby(process.name)", "description": "Well-known high-reliability reputation processes", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"taskkill.exe\")groupby(process.cmd_line)", "description": "Taskkill usage and command lines", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"PsLoggedon.exe\")groupby(hostname, process.username)", "description": "PsLoggedon utility usage", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name='ScreenCapture.exe')groupby(hostname, process.username)", "description": "ScreenCapture usage by host and user", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.exe_file.description icontains-any [\"ssh\", \"telnet\"])groupby(process.name, hostname, process.username)", "description": "SSH and Telnet detection by process, host, and user", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"whoami.exe\")groupby(hostname, process.username)", "description": "Whoami command execution tracking", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"powershell.exe\")groupby(parent_process.name)", "description": "PowerShell parent process identification", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(parent_process.name=\"powershell.exe\")groupby(process.name)", "description": "PowerShell child processes", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(parent_process.name=\"powershell.exe\" AND parent_process.cmd_line NOT IIN [\"null\", \".ps1\"])groupby(parent_process.cmd_line)", "description": "PowerShell non-empty parent command lines", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"powershell.exe\" AND process.cmd_line NOT IIN [\"null\", \".ps1\"])groupby(process.cmd_line)", "description": "PowerShell non-empty child command lines", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"powershell_ise.exe\" OR parent_process.name=\"powershell_ise.exe\")groupby(hostname)calculate(unique:hostname)", "description": "PowerShell ISE detection across hosts", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"psexec.exe\")groupby(process.cmd_line)", "description": "All PsExec command line arguments", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"psexec.exe\" AND process.cmd_line icontains \".s.\")groupby(process.cmd_line)", "description": "PsExec system account execution", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"psexec.exe\" AND process.cmd_line icontains \".s.\" AND /psexec.exe \\(?P<remote_asset>[^ ]*)/)groupby(remote_asset)", "description": "Remote system account PsExec with regex field extraction", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name=\"cmd.exe\" AND process.cmd_line ISTARTS-WITH \"cmd.exe /C\")groupby(process.cmd_line)", "description": "Command execution with /C flag detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.cmd_line icontains \"attrib -h -s -r\")", "description": "File attribute removal attempts detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.name IIN [\"Netplwiz.exe\", \"lusmgr.msc\"])groupby(hostname, process.username)", "description": "User account management tool launches", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.cmd_line icontains-all [\"\\downloads\\\",\"setup.exe\"])groupby(process.cmd_line)", "description": "Downloads folder setup.exe execution detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.cmd_line ISTARTS-WITH-ANY [\"tasklist\", \"ver\", \"ipconfig\", \"systeminfo\", \"net time\", \"netstat\", \"whoami\", \"net start\", \"qprocess\", \"query\"])groupby(hostname, process.cmd_line)", "description": "Initial reconnaissance command detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.cmd_line ISTARTS-WITH-ANY [\"dir\", \"net view\", \"ping\", \"net use\", \"type\", \"net user\", \"net localgroup\", \"net group\", \"net config\", \"net share\"])groupby(hostname, process.cmd_line)", "description": "Network reconnaissance command detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.cmd_line ISTARTS-WITH-ANY [\"at\", \"reg\", \"wmic\", \"netsh advfirewall\", \"sc\", \"rundll32\"])groupby(hostname, process.cmd_line)", "description": "Infection spread command detection", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "where(process.exe_file.hashes.sha1=\"hash_value\") groupby(hostname) calculate(count)", "description": "Malicious hash detection across endpoints", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},

  {"query": "where(sale_total>0) calculate(SUM:sale_total)", "description": "Sum of sale totals above zero", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(sale_total>0) calculate(AVERAGE:sale_total)", "description": "Average of sale totals above zero", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status) groupby(status) calculate(count)", "description": "Groupby status with count", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status) groupby(status) calculate(count) sort(desc) limit(350)", "description": "Groupby status sorted descending with limit", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status>=300) groupby(status) calculate(count) sort(desc)", "description": "Status codes 300+ sorted by count descending", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "groupby(username) calculate(count) sort(asc#key)", "description": "Usernames sorted alphabetically by key name", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status=500) calculate(count) timeslice(60)", "description": "Count of 500 errors per minute (60 intervals)", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status=500) calculate(count) timeslice(30s)", "description": "Count of 500 errors in 30-second intervals", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status=500) calculate(count) timeslice(5m)", "description": "Count of 500 errors in 5-minute intervals", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(status=500) calculate(count) timeslice(1h)", "description": "Count of 500 errors in hourly intervals", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "calculate(pctl(99):RecordNumber)", "description": "99th percentile of RecordNumber to exclude outliers", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "where(/.*/) calculate(bytes)", "description": "Calculate total log size in bytes (match-all regex)", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "calculate(standarddeviation:service)", "description": "Standard deviation of service values", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},
  {"query": "calculate(sd:service)", "description": "Standard deviation shorthand for service", "source": "https://docs.rapid7.com/insightops/analytic-functions-and-visualizations/"},

  {"query": "remoteIP = /\"197\\.149\\.[12][0-59][0-9]\\.[0-2].*\\/NX\"/", "description": "IP range search with regex on JSON field (Apache Access Logs)", "source": "https://docs.rapid7.com/insightops/regular-expression-search/"},
  {"query": "where(/total sale (?P<saleValue>\\d*)/) calculate(average:saleValue)", "description": "Named capture group extraction with average calculation", "source": "https://docs.rapid7.com/insightops/regular-expression-search/"},

  {"query": "groupby(dns_domain)", "description": "Group by DNS domain", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "groupby(os_type)", "description": "Group by operating system type", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "groupby(process.exe_file.description)", "description": "Group by executable file description", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},
  {"query": "groupby(process.exe_file.product_name)", "description": "Group by executable product name", "source": "https://docs.rapid7.com/insightidr/leverage-enhanced-endpoint-telemetry-data/"},

  {"query": "where(source_json.ApplicationId=\"app-id-here\")groupby(account)", "description": "All accounts ingressed into application by specific Application ID", "source": "https://docs.rapid7.com/insightidr/example-queries/"},

  {"query": "calculate(unique:source_address)", "description": "Count of unique source addresses", "source": "https://docs.rapid7.com/insightidr/components-for-building-a-query/"},
  {"query": "groupby(#log)", "description": "Group by log set or log source", "source": "https://docs.rapid7.com/insightidr/components-for-building-a-query/"}
]
